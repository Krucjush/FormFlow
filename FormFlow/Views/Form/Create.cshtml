@model FormViewModel

@{
	ViewData["Title"] = "Create Form";
}

<h2>Create Form</h2>

<form method="post" class="mt-4">
	<div class="row">
		<div class="col-6 px-3">
			<h4>Create:</h4>
			<div class="mb-3">
				<label asp-for="Form.Title">Title</label>
				<input asp-for="Form.Title" class="form-control" />
				<span asp-validation-for="Form.Title" class="text-danger"></span>
			</div>
			<h4>Questions:</h4>
			<div class="mb-3">
				@for (var i = 0; i < Model.Questions.Count; i++)
				{
					<div class="mb-3">
						<label asp-for="Questions[i].Text">Question @(i + 1)</label>
						<input asp-for="Questions[i].Text" class="form-control" />
						<span asp-validation-for="Questions[i].Text" class="text-danger"></span>
					</div>
				}
				<button type="button" id="addQuestionBtn" class="btn btn-primary">Add Question</button>
			</div>
		</div>
	</div>
    <button type="submit" class="btn btn-success float-end">Create</button>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha384-HA7Atf+7H3j5Bk4qcbmu3Nlw2M9HTF30V0GzYFGi+1bD3xORrA1XUap+oAxRs1Hs" crossorigin="anonymous"></script>
@section Scripts {
	<script>
        $(document).ready(function () {
            var questionIndex = @Model.Questions.Count;
            var addQuestionBtn = $("#addQuestionBtn");
            
            addQuestionBtn.click(function () {
                var questionGroup = $("<div>")
                    .addClass("question-group mb-3");
                var label = $("<label>")
                    .attr("for", "Form_Questions_" + questionIndex + "__Text")
                    .text("Question " + (questionIndex + 1));
                var input = $("<input>")
                    .attr("type", "text")
                    .attr("name", "Form.Questions[" + questionIndex + "].Text")
                    .attr("id", "Form_Questions_" + questionIndex + "__Text")
                    .addClass("form-control");
                var validationMessage = $("<span>")
                    .addClass("text-danger")
                    .attr("data-valmsg-for", "Form.Questions[" + questionIndex + "].Text");

                questionGroup.append(label);
                questionGroup.append(input);
                questionGroup.append(validationMessage);

                questionGroup.insertBefore(addQuestionBtn);

                questionIndex++;
            });
        });
    </script>
}